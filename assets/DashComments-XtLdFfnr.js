import{j as e,L as N,aP as w,aQ as I,g as k,A as S,f as L,r as t,h as p,aw as j,P as U,aS as $,aT as R,z as C}from"./index-CaBtqeQH.js";import{M as _}from"./Modal-oYdNYG3E.js";import{P as B}from"./PaginationButtons-yRwDtzUB.js";import{T as A}from"./TableBodySkeleton -DAQmHRwF.js";const F=({loading:l,commentPerPage:s,commentsToShow:u,setActionType:m,setItemToModify:r,setShowModal:i})=>e.jsxDEV("div",{className:"w-full bg-white dark:bg-slate-800 rounded-xl shadow-md overflow-x-auto",children:e.jsxDEV("table",{className:"w-full text-sm text-right",children:[e.jsxDEV("thead",{className:"text-xs text-gray-700 dark:text-gray-300 uppercase bg-gray-50 dark:bg-gray-700",children:e.jsxDEV("tr",{children:[e.jsxDEV("th",{className:"px-6 py-3",children:"تاریخ"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:18,columnNumber:13},void 0),e.jsxDEV("th",{className:"px-6 py-3",children:"متن نظر کاربر"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:19,columnNumber:13},void 0),e.jsxDEV("th",{className:"px-6 py-3",children:"پست مربوطه"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:20,columnNumber:13},void 0),e.jsxDEV("th",{className:"px-6 py-3",children:"کاربر"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:21,columnNumber:13},void 0),e.jsxDEV("th",{className:"px-6 py-3",children:"وضعیت مسدودیت"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:22,columnNumber:13},void 0),e.jsxDEV("th",{className:"px-6 py-3",children:"عملیات"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:23,columnNumber:13},void 0)]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:17,columnNumber:11},void 0)},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:16,columnNumber:9},void 0),l?e.jsxDEV(A,{rows:s},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:27,columnNumber:11},void 0):e.jsxDEV("tbody",{className:"divide-y dark:divide-gray-700",children:u.map(n=>e.jsxDEV("tr",{className:"bg-white dark:bg-gray-800 hover:bg-gray-50 dark:hover:bg-gray-600",children:[e.jsxDEV("td",{className:"px-6 py-4 dark:text-white",children:new Date(n.createdAt).toLocaleDateString("fa-IR")},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:35,columnNumber:17},void 0),e.jsxDEV("td",{className:"px-6 py-4 dark:text-white",children:e.jsxDEV(N,{to:`/post/${n.postId?.slug}#comment-${n._id}`,className:"hover:underline",children:n.content},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:39,columnNumber:19},void 0)},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:38,columnNumber:17},void 0),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV(N,{to:`/post/${n.postId?.slug}`,className:"hover:underline text-blue-500",children:n.postId?.title||"پست حذف شده"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:47,columnNumber:19},void 0)},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:46,columnNumber:17},void 0),e.jsxDEV("td",{className:"px-6 py-4",children:e.jsxDEV(N,{to:`/dashboard?tab=users&userId=${n.userId?._id}`,className:"hover:underline text-teal-500",children:n.userId?.username||"کاربر حذف شده"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:55,columnNumber:19},void 0)},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:54,columnNumber:17},void 0),e.jsxDEV("td",{className:"px-6 py-4 text-center",children:n.userId?n.userId.isBanned?e.jsxDEV(w,{className:"text-green-500 mx-auto"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:65,columnNumber:23},void 0):e.jsxDEV(I,{className:"text-red-500 mx-auto"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:67,columnNumber:23},void 0):"-"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:62,columnNumber:17},void 0),e.jsxDEV("td",{className:"px-6 py-4 flex flex-col gap-2",children:[e.jsxDEV("span",{onClick:()=>{m("delete"),r(n),i(!0)},className:"text-red-500 font-medium hover:underline cursor-pointer",children:"حذف نظر"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:74,columnNumber:19},void 0),n.userId&&(n.userId.isBanned?e.jsxDEV("span",{onClick:()=>{m("unban"),r(n),i(!0)},className:"text-green-500 font-medium hover:underline cursor-pointer",children:"رفع مسدودیت"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:86,columnNumber:23},void 0):e.jsxDEV("span",{onClick:()=>{m("ban"),r(n),i(!0)},className:"text-orange-500 font-medium hover:underline cursor-pointer",children:"مسدود کردن"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:97,columnNumber:23},void 0))]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:73,columnNumber:17},void 0)]},n._id,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:31,columnNumber:15},void 0))},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:29,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:15,columnNumber:7},void 0)},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/comment/CommentsTable.jsx",lineNumber:14,columnNumber:5},void 0),G=()=>{const l=k(),s=S(),u=L(),[m,r]=t.useState([]),[i,n]=t.useState(!1),[c,g]=t.useState(null),[d,E]=t.useState(""),{currentUser:b}=p(o=>o.user),{allComments:h,totalComments:f,loading:y,error:M}=p(o=>o.comment),{settings:v}=p(o=>o.settings);t.useEffect(()=>{if(b.role==="admin"){const o=new URLSearchParams(s.search);l(j(o.toString()))}},[s.search,b,l]),t.useEffect(()=>{r(h)},[h,f]);const D=()=>{n(!1);let o,a="";d==="delete"?(o=U(c._id),a="دیدگاه با موفقیت حذف شد."):d==="ban"?(o=$(c.userId._id),a=`کاربر ${c.userId.username} مسدود شد.`):d==="unban"&&(o=R(c.userId._id),a=`کاربر ${c.userId.username} رفع مسدودیت شد.`),l(o).unwrap().then(()=>{C.success(a),l(j(new URLSearchParams(s.search).toString()))}).catch(V=>C.error(V))},P=o=>{const a=new URLSearchParams(s.search);a.set("startIndex",o),u(`/dashboard?tab=comments&${a.toString()}`)},x=v.rowsIndex||9,T=parseInt(new URLSearchParams(s.search).get("startIndex"))||0;return e.jsxDEV("div",{className:"max-w-7xl mx-auto py-10",children:[b.role==="admin"&&m.length>0?e.jsxDEV(e.Fragment,{children:[e.jsxDEV("h1",{className:"text-2xl dark:text-white font-bold mb-6",children:["مدیریت دیدگاه ها (",f,")"]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:86,columnNumber:11},void 0),e.jsxDEV(F,{loading:y,commentPerPage:x,commentsToShow:m,setActionType:E,setItemToModify:g,setShowModal:n},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:90,columnNumber:11},void 0),e.jsxDEV(B,{handlePageChange:P,totalDataNumber:f,rowsIndex:x,startIndex:T},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:99,columnNumber:11},void 0)]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:85,columnNumber:9},void 0):e.jsxDEV("p",{children:"هیچ دیدگاهی برای نمایش وجود ندارد."},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:107,columnNumber:9},void 0),e.jsxDEV(_,{isOpen:i,onClose:()=>n(!1),onConfirm:D,title:d==="delete"?"حذف نظر کاربر":d==="ban"?"مسدود کردن کاربر":"رفع مسدودیت کاربر",children:"آیا از انجام این عملیات اطمینان دارید؟"},void 0,!1,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:109,columnNumber:7},void 0)]},void 0,!0,{fileName:"E:/Project/final-blog - Copy/client/src/components/dashboard/DashComments.jsx",lineNumber:83,columnNumber:5},void 0)};export{G as default};
